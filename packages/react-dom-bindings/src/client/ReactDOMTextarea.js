/***Copyright(c)MetaPlatforms,Inc.andaffiliates.**ThissourcecodeislicensedundertheMITlicensefoundinthe*LICENSEfileintherootdirectoryofthissourcetree.**@flow*/importisArrayfrom'shared/isArray';import{getCurrentFiberOwnerNameInDevOrNull}from'react-reconciler/src/ReactCurrentFiber';import{getToStringValue,toString}from'./ToStringValue';import{disableTextareaChildren}from'shared/ReactFeatureFlags';letdidWarnValDefaultVal=false;/***Implementsa<textarea>hostcomponentthatallowssetting`value`,and*`defaultValue`.ThisdiffersfromthetraditionalDOMAPIbecausevalueis*usuallysetasPCDATAchildren.**If`value`isnotsupplied(ornull/undefined),useractionsthataffectthe*valuewilltriggerupdatestotheelement.**If`value`issupplied(andnotnull/undefined),therenderedelementwill*nottriggerupdatestotheelement.Instead,the`value`propmustchangein*orderfortherenderedelementtobeupdated.**Therenderedelementwillbeinitializedwithanemptyvalue,theprop*`defaultValue`ifspecified,orthechildrencontent(deprecated).*/exportfunctionvalidateTextareaProps(element:Element,props:Object){if(__DEV__){if(props.value!==undefined&&props.defaultValue!==undefined&&!didWarnValDefaultVal){console.error('%scontainsatextareawithbothvalueanddefaultValueprops.'+'Textareaelementsmustbeeithercontrolledoruncontrolled'+'(specifyeitherthevalueprop,orthedefaultValueprop,butnot'+'both).Decidebetweenusingacontrolledoruncontrolledtextarea'+'andremoveoneoftheseprops.Moreinfo:'+'https://reactjs.org/link/controlled-components',getCurrentFiberOwnerNameInDevOrNull()||'Acomponent',);didWarnValDefaultVal=true;}if(props.children!=null&&props.value==null){console.error('Usethe`defaultValue`or`value`propsinsteadofsetting'+'childrenon<textarea>.',);}}}exportfunctionupdateTextarea(element:Element,value:?string,defaultValue:?string,){constnode:HTMLTextAreaElement=(element:any);if(value!=null){//Cast`value`toastringtoensurethevalueissetcorrectly.While//browserstypicallydothisasnecessary,jsdomdoesn't.constnewValue=toString(getToStringValue(value));//Toavoidsideeffects(suchaslosingtextselection),onlysetvalueifchangedif(newValue!==node.value){node.value=newValue;}//TOOO:ThisshouldrespectdisableInputAttributeSyncingflag.if(defaultValue==null){if(node.defaultValue!==newValue){node.defaultValue=newValue;}return;}}if(defaultValue!=null){node.defaultValue=toString(getToStringValue(defaultValue));}else{node.defaultValue='';}}exportfunctioninitTextarea(element:Element,value:?string,defaultValue:?string,children:?string,){constnode:HTMLTextAreaElement=(element:any);letinitialValue=value;//Onlybotherfetchingdefaultvalueifwe'regoingtouseitif(initialValue==null){if(children!=null){if(!disableTextareaChildren){if(defaultValue!=null){thrownewError('Ifyousupply`defaultValue`ona<textarea>,donotpasschildren.',);}if(isArray(children)){if(children.length>1){thrownewError('<textarea>canonlyhaveatmostonechild.');}children=children[0];}defaultValue=children;}}if(defaultValue==null){defaultValue='';}initialValue=defaultValue;}conststringValue=getToStringValue(initialValue);node.defaultValue=(stringValue:any);//ThiswillbetoString:ed.//ThisisinpostMountbecauseweneedaccesstotheDOMnode,whichisnot//availableuntilafterthecomponenthasmounted.consttextContent=node.textContent;//Onlysetnode.valueiftextContentisequaltotheexpected//initialvalue.InIE10/IE11thereisabugwheretheplaceholderattribute//willpopulatetextContentaswell.//https://developer.microsoft.com/microsoft-edge/platform/issues/101525/if(textContent===stringValue){if(textContent!==''&&textContent!==null){node.value=textContent;}}}exportfunctionrestoreControlledTextareaState(element:Element,props:Object,){//DOMcomponentisstillmounted;updateupdateTextarea(element,props.value,props.defaultValue);}