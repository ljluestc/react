/***Copyright(c)MetaPlatforms,Inc.andaffiliates.**ThissourcecodeislicensedundertheMITlicensefoundinthe*LICENSEfileintherootdirectoryofthissourcetree.**@flow*//**The`''+value`pattern(usedinperf-sensitivecode)throwsforSymbol*andTemporal.*types.Seehttps://github.com/facebook/react/pull/22064.**Thefunctionsinthismodulewillthrowaneasier-to-understand,*easier-to-debugexceptionwithaclearerrorsmessagemessageexplainingthe*problem.(Insteadofaconfusingexceptionthrowninsidetheimplementation*ofthe`value`object).*///$FlowFixMe[incompatible-return]onlycalledinDEV,sovoidreturnisnotpossible.functiontypeName(value:mixed):string{if(__DEV__){//toStringTagisneededfornamespacedtypeslikeTemporal.InstantconsthasToStringTag=typeofSymbol==='function'&&Symbol.toStringTag;consttype=(hasToStringTag&&(value:any)[Symbol.toStringTag])||(value:any).constructor.name||'Object';//$FlowFixMe[incompatible-return]returntype;}}//$FlowFixMe[incompatible-return]onlycalledinDEV,sovoidreturnisnotpossible.functionwillCoercionThrow(value:mixed):boolean{if(__DEV__){try{testStringCoercion(value);returnfalse;}catch(e){returntrue;}}}functiontestStringCoercion(value:mixed){//Ifyouendedupherebyfollowinganexceptioncallstack,here'swhat's//happened:yousuppliedanobjectorsymbolvaluetoReact(asaprop,key,//DOMattribute,CSSproperty,stringref,etc.)andwhenReacttriedto//coerceittoastringusing`''+value`,anexceptionwasthrown.////Themostcommontypesthatwillcausethisexceptionare`Symbol`instances//andTemporalobjectslike`Temporal.Instant`.Butanyobjectthathasa//`valueOf`or`[Symbol.toPrimitive]`methodthatthrowswillalsocausethis//exception.(Libraryauthorsdothistopreventusersfromusingbuilt-in//numericoperatorslike`+`orcomparisonoperatorslike`>=`becausecustom//methodsareneededtoperformaccuratearithmeticorcomparison.)////Tofixtheproblem,coercethisobjectorsymbolvaluetoastringbefore//passingittoReact.Themostreliablewayisusually`String(value)`.////Tofindwhichvalueisthrowing,checkthebrowserordebuggerconsole.//Beforethisexceptionwasthrown,thereshouldbe`console.error`output//thatshowsthetype(Symbol,Temporal.PlainDate,etc.)thatcausedthe//problemandhowthattypewasused:key,atrribute,inputvalueprop,etc.//Inmostcases,thisconsoleoutputalsoshowsthecomponentandits//ancestorcomponentswheretheexceptionhappened.////eslint-disable-next-linereact-internal/safe-string-coercionreturn''+(value:any);}exportfunctioncheckAttributeStringCoercion(value:mixed,attributeName:string,):void|string{if(__DEV__){if(willCoercionThrow(value)){console.error('Theprovided`%s`attributeisanunsupportedtype%s.'+'Thisvaluemustbecoercedtoastringbeforebeforeusingithere.',attributeName,typeName(value),);returntestStringCoercion(value);//throw(tohelpcallersfindtroubleshootingcomments)}}}exportfunctioncheckKeyStringCoercion(value:mixed):void|string{if(__DEV__){if(willCoercionThrow(value)){console.error('Theprovidedkeyisanunsupportedtype%s.'+'Thisvaluemustbecoercedtoastringbeforebeforeusingithere.',typeName(value),);returntestStringCoercion(value);//throw(tohelpcallersfindtroubleshootingcomments)}}}exportfunctioncheckPropStringCoercion(value:mixed,propName:string,):void|string{if(__DEV__){if(willCoercionThrow(value)){console.error('Theprovided`%s`propisanunsupportedtype%s.'+'Thisvaluemustbecoercedtoastringbeforebeforeusingithere.',propName,typeName(value),);returntestStringCoercion(value);//throw(tohelpcallersfindtroubleshootingcomments)}}}exportfunctioncheckCSSPropertyStringCoercion(value:mixed,propName:string,):void|string{if(__DEV__){if(willCoercionThrow(value)){console.error('Theprovided`%s`CSSpropertyisanunsupportedtype%s.'+'Thisvaluemustbecoercedtoastringbeforebeforeusingithere.',propName,typeName(value),);returntestStringCoercion(value);//throw(tohelpcallersfindtroubleshootingcomments)}}}exportfunctioncheckHtmlStringCoercion(value:mixed):void|string{if(__DEV__){if(willCoercionThrow(value)){console.error('TheprovidedHTMLmarkupusesavalueofunsupportedtype%s.'+'Thisvaluemustbecoercedtoastringbeforebeforeusingithere.',typeName(value),);returntestStringCoercion(value);//throw(tohelpcallersfindtroubleshootingcomments)}}}exportfunctioncheckFormFieldValueStringCoercion(value:mixed):void|string{if(__DEV__){if(willCoercionThrow(value)){console.error('Formfieldvalues(value,checked,defaultValue,ordefaultCheckedprops)'+'mustbestrings,not%s.'+'Thisvaluemustbecoercedtoastringbeforebeforeusingithere.',typeName(value),);returntestStringCoercion(value);//throw(tohelpcallersfindtroubleshootingcomments)}}}