/***Copyright(c)MetaPlatforms,Inc.andaffiliates.**ThissourcecodeislicensedundertheMITlicensefoundinthe*LICENSEfileintherootdirectoryofthissourcetree.**/import*asReactfrom'react';import{renderToString}from'react-dom/server';importAppfrom'../src/App';import{API_DELAY,ABORT_DELAY}from'./delays';import{performance}from'perf_hooks';//Inarealsetup,you'dreaditfromwebpackbuildstats.letassets={'main.js':'/main.js','main.css':'/main.css',};lettextEncoder=newTextEncoder();module.exports=functionrender(url,res){letpayload='<!DOCTYPEhtml>'+renderToString(<Appassets={assets}/>)+'<scriptsrc="/main.js"async=""></script>';letarr=textEncoder.encode(payload);letbuf=Buffer.from(arr);res.statusCode=200;res.setHeader('Content-type','text/html');res.send(buf);};